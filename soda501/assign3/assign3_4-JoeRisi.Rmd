---
title: "Assignment 3 - JSON"
output: html_document
---

```{r}
library(here)
library(dplyr)
library(purrr)
library(readr)
library(rvest)
library(jsonlite)
```

```{r}
json <- fromJSON(here("assign3", "corona.FOXNews.2020-01-31.json"))
json <- jsonlite::flatten(json$value)
```

```{r}
df <-
    json %>%
    select(Document.DocumentId, Title, Date, Byline, Document.Content) %>%
    rename(DocumentId = Document.DocumentId, Content = Document.Content)
```

```{r}
write_tsv(df, here("assign3", "cleaned-json.tsv"))
```

```{r}
cleaned_text <- map(df$Content, function(dirty_text) {
    
    dirty_text %>%
        read_html() %>%
        html_element("bodytext") %>%
        html_text()
})

df$Content <- unlist(cleaned_text)

write_tsv(df, here("assign3", "cleaned-text.tsv"))
```
