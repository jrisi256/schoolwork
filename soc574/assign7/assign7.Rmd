---
title: "Assignment 7"
output: html_document
---

```{r}
library(here)
library(dplyr)
library(purrr)
library(ggplot2)
```

* **age**: Age of household head.
* **educ**: Years of education for the household head.
* **earnings**: Annual earnings for the household head in 1996.
* **hours**: Annual hours worked for the household head in 1996.
* *married*: Marriage indicator for household head.
    * 1 = married
    * 0 = not married

```{r}
data <-
    haven::read_dta(here("data", "psid97.dta")) %>%
    filter(across(everything(), ~ !is.na(.x)))
```

## Question 0 - Creating new variables

* **hourly_wage**: Estimated average hourly wage found by dividing **earnings** by **hours**.
* **employed**: Indicates if head of household had recorded work or not in 1996 (**hours** is greater than 0).
    * 1 = worked
    * 0 = no recorded work
* **labor_exprnc**: Years of labor market experience (**age** - **educ** - 6).

```{r}
dataNew <-
    data %>%
    mutate(hourly_wage = if_else(hours != 0, earnings / hours, 0),
           employed = if_else(hours > 0, 1, 0),
           labor_exprnc = age - educ - 6)
```

```{r}
map(dataNew, summary)
```

## Question 1

Limit analysis only to households where the head is working

```{r}
dataWorking <- dataNew %>% filter(employed == 1)
```

**Parts A and B**

```{r}
ggplot(dataWorking, aes(x = labor_exprnc, y = hourly_wage)) +
    geom_point() +
    geom_smooth(method = "lm", se = F, formula = y ~ x) +
    scale_y_continuous(breaks = seq(0, 250, 25)) +
    theme_bw()

cor(dataWorking$labor_exprnc, dataWorking$hourly_wage)
```

The sample correlation is quite weak. Both the *eyeball test* as well as the numerically calculated correlation indicate there isn't much of an association between the two variables. This is counterintuitive because one would think the more labor market experience a person had the higher their wages would be. There are a vast number of explanations which might explain why the two aren't related:

* the relationship could be mediated by demographics (race, gender, age).
* it might be the case one needs *relevant* work experience thus not all years of work experience are created equal.
* etc.

**Part C**

```{r}
ols <- lm(hourly_wage ~ labor_exprnc, data = dataWorking)
summary(ols)
qf(0.95, df1 = 2880, df2 = 1)
qf(0.95, df1 = 1, df2 = 2880)
df(48, df1 = 1, df2 = nrow(dataWorking) - 2)
```
The estimate for $\beta_1$ is 0.20998. It is significantly different from 0 at 0.05 significance level. This means in this sample for each year of work experience accumulated you would, on average, earn about 21 cents more per hour.

**Part D**

The F-statistic for the model is 43 (with 1 and 2880 degrees of freedom).